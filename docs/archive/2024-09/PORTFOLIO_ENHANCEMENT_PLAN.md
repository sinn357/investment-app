# 포트폴리오 시스템 고도화 계획

## 개요
포트폴리오 관리 시스템의 사용자 경험과 정확성을 개선하기 위한 4가지 주요 개선사항을 단계적으로 구현합니다.

## 목표
1. 부동산 투자 형태의 정확한 반영 (월세/전세)
2. 해외 자산 입력 가이드 개선
3. ETF 상세 정보 확장
4. 예금/적금 실제 수익률 계산 정교화

---

## Phase 1: 핵심 개선 사항

### 1.1 부동산 월세/전세 선택 시스템
**현재 상황**: 임대수익(월세)만 지원
**개선 계획**:
- 라디오 버튼으로 "월세" vs "전세" 선택
- 월세 선택: 월 임대수익 입력 필드
- 전세 선택: 전세보증금 입력 필드 (임대수익 대신)
- 수익률 계산 로직 분기 처리

**기술적 구현**:
```typescript
interface RealEstateFields {
  rentType: 'monthly' | 'jeonse';  // 임대 유형
  monthlyRent?: number;            // 월세 (rentType='monthly'일 때)
  jeonseDeposit?: number;          // 전세보증금 (rentType='jeonse'일 때)
}
```

### 1.2 예금/적금 복리 및 세금 시스템
**현재 상황**: 단순 연이율만 입력
**개선 계획**:
- 복리 유형 선택: 단리/일복리/월복리/연복리
- 세금 처리 옵션: 세전/세후 수익률 또는 세율 직접 입력
- 실제 수령액 자동 계산

**기술적 구현**:
```typescript
interface SavingsFields {
  compoundType: 'simple' | 'daily' | 'monthly' | 'yearly';  // 복리 유형
  taxOption: 'pre_tax' | 'post_tax' | 'custom';             // 세금 처리
  taxRate?: number;                                         // 세율 (custom일 때)
  effectiveReturn?: number;                                 // 실효 수익률
}
```

---

## Phase 2: 부가 기능 개선

### 2.1 해외 자산 입력 가이드 개선
**현재 상황**: 암묵적으로 원화 입력 기대
**개선 계획**:
- 해외주식/ETF/펀드/채권 입력 폼에 안내 문구 추가
- "해외 자산은 현재 환율을 적용하여 원화로 환산 후 입력해주세요" 표시
- 환율 참고 링크 제공 (예: 네이버 금융, 한국은행)

### 2.2 ETF 구성종목 선택적 표시
**현재 상황**: ETF 기본 정보만 표시
**개선 계획**:
- "주요 구성종목" 텍스트 필드 추가 (선택사항)
- 사용자가 원할 경우 상위 종목 수동 입력
- 예시: "삼성전자(23%), TSMC(12%), 엔비디아(8%)..."

**기술적 구현**:
```typescript
interface ETFFields {
  topHoldings?: string;  // 주요 구성종목 (선택사항)
}
```

---

## Phase 3: 고도화 (장기 계획)

### 3.1 환율 API 연동
- 실시간 환율 정보 제공
- 해외 자산 자동 환산 계산
- 환율 변동 히스토리 추적

### 3.2 고급 세금 계산
- 자산 유형별 세율 자동 적용
- 연간 세금 시뮬레이션
- 절세 최적화 제안

---

## 구현 순서

### Week 1: Phase 1.1 - 부동산 시스템
1. **백엔드 스키마 확장**
   - `assets` 테이블에 `rent_type`, `monthly_rent`, `jeonse_deposit` 컬럼 추가
   - 기존 데이터 마이그레이션 로직

2. **프론트엔드 UI 개선**
   - 부동산 소분류 선택 시 임대 유형 라디오 버튼 표시
   - 조건부 필드 렌더링 (월세/전세)
   - 수정 모달에도 동일 로직 적용

3. **수익률 계산 로직 분기**
   - 월세: 기존 로직 유지 (월세×12/투자원금)
   - 전세: 전세보증금 기준 계산 로직 개발

### Week 2: Phase 1.2 - 예금/적금 시스템
1. **복리 계산 시스템**
   - 복리 유형별 계산 함수 구현
   - 만기 시 예상 수령액 계산

2. **세금 처리 시스템**
   - 이자소득세 자동 계산 (15.4%)
   - 세전/세후 수익률 변환 로직

3. **UI 개선**
   - 복리 유형 드롭다운
   - 세금 처리 옵션 선택
   - 실수령액 미리보기

### Week 3: Phase 2 구현
1. **해외 자산 가이드**
   - 입력 폼 안내 문구 추가
   - 환율 참고 링크 제공

2. **ETF 구성종목**
   - 선택적 텍스트 필드 추가
   - 자산 상세 보기에 구성종목 표시

---

## 기대 효과

### 사용자 경험 개선
- 실제 투자 상황을 정확히 반영
- 복잡한 계산을 자동화하여 편의성 증대
- 더 정확한 포트폴리오 분석 가능

### 데이터 정확성 향상
- 부동산 투자 유형별 수익률 정확한 계산
- 세금을 고려한 실제 수익률 제공
- 해외 자산 환율 혼동 방지

### 시스템 확장성
- 향후 고도화 기능의 기반 마련
- 모듈화된 계산 로직으로 유지보수성 향상

---

## 리스크 및 대응방안

### 데이터 마이그레이션 리스크
- **리스크**: 기존 부동산 데이터 호환성 문제
- **대응**: 기존 데이터는 "월세" 기본값으로 설정

### 계산 복잡성 증가
- **리스크**: 복리/세금 계산 로직 복잡화
- **대응**: 단위 테스트 강화, 계산 검증 로직 추가

### 사용자 혼동
- **리스크**: 너무 많은 옵션으로 인한 사용자 혼동
- **대응**: 기본값 설정, 도움말 툴팁 제공

---

## 성공 지표

### 정량적 지표
- 포트폴리오 데이터 입력 완성률 증가
- 부동산/예금 자산 등록 시 세부 정보 입력률
- 계산 정확도 개선 (세전 vs 세후 수익률 비교)

### 정성적 지표
- 실제 투자 상황 반영도 향상
- 사용자 피드백을 통한 만족도 측정
- 포트폴리오 분석 신뢰성 증가

---

## 다음 단계

1. **Phase 1.1 부동산 시스템부터 착수**
2. **백엔드 스키마 설계 및 마이그레이션**
3. **프론트엔드 UI 컴포넌트 개발**
4. **테스트 및 검증 후 Phase 1.2 진행**

각 단계별 상세 구현 가이드는 별도 문서로 작성 예정.